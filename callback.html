<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Authentication Callback</title>
</head>
<body>
    <p>Processing authentication...</p>
    <script>
        (function() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');
            const error = urlParams.get('error');
            const errorDescription = urlParams.get('error_description');

            if (window.opener) {
                if (error) {
                    // Redirect the opener and pass the error in the hash
                    window.opener.location.href = `${window.location.origin}/#error=${error}&error_description=${encodeURIComponent(errorDescription || 'Unknown error')}`;
                } else if (code) {
                    // Redirect the opener and pass the code in the hash
                    window.opener.location.href = `${window.location.origin}/#code=${code}`;
                }
                // Close the popup
                window.close();
            } else {
                document.body.textContent = 'Error: Could not find the main application window. Please close this window and try again.';
            }
        })();
    </script>
</body>
</html>
